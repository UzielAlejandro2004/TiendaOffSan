<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Interactivo Tienda</title>
    <style>
        body {background: #fdf6f0;font-family: Arial,sans-serif;margin:0;height:100vh;display:flex;justify-content:center;align-items:center;}
        #chatbot {background: #fff; width: 410px; border-radius:18px; box-shadow: 0 8px 35px rgba(252,108,133,0.22); overflow:hidden; display:flex; flex-direction:column;}
        #header {background: linear-gradient(90deg,#fc6c85,#2e3353);color:#fff;text-align:center;font-size:1.18em;font-weight:bold;padding:18px;}
        #messages {background: #fff0f5; padding: 18px 16px 12px 16px; height: 355px; font-size:1em;overflow-y:auto;}
        #input-box {display:flex;width:100%;background:#fdf6f0;}
        #input {flex:1; padding:12px 8px; border:none; font-size:1em;background:transparent;outline:none;}
        #send {background:#fc6c85; color:#fff; border:none; padding:0 23px; cursor:pointer; font-size:1.12em; font-weight:600; transition:background 0.2s;}
        #send:hover {background:#ff5678;}
        #end-btn {background:#ff5678;color:white;border:none;border-radius:7px;padding:8px 15px;font-size:1em;font-weight:bold;cursor:pointer;margin:12px 0 0 0;}
        #end-btn:hover {background:#2e3353;}
        .bot {margin:6px 0; font-size:1em;}
        .user {margin:6px 0;text-align:right;}
        .option-btn {padding:6px 16px;margin:3px 8px 6px 0;background:#fc6c85;color:white;border:none;border-radius:8px;font-size:1em;cursor:pointer;}
        .option-btn:hover{background:#ff5678;}
        .producto-tarjeta { display:flex;align-items:center;background:#fff;border:1px solid #fc6c85;border-radius:9px;padding:10px 8px;margin:6px 0;}
        .producto-tarjeta img { width:56px;height:56px;object-fit:cover;border-radius:7px;margin-right:12px; }
    </style>
</head>
<body>
    <div id="chatbot">
        <div id="header">ü§ñ Asistente Interactivo de la Tienda</div>
        <div id="messages"></div>
        <div id="input-box">
            <input id="input" type="text" placeholder="Escribe tu mensaje..." autocomplete="off" />
            <button id="send">Enviar</button>
        </div>
        <button id="end-btn" onclick="finalizarChat()">Finalizar Chat</button>
    </div>
<script>
const productos = [
  // Ropa Mujer
  {nombre:"Vestido Elegante", categoria:"Ropa Mujer", precio:"$699", img:"imagenes/imagenes/Ropa de mujer/vestidos.jpg"},
  {nombre:"Blusa de Moda", categoria:"Ropa Mujer", precio:"$349", img:"imagenes/imagenes/Ropa de mujer/BlusasDeModa.jpg"},
  {nombre:"Jeans Casual", categoria:"Ropa Mujer", precio:"$550", img:"imagenes/imagenes/Ropa de mujer/JeansCasual.jpg"},
  {nombre:"Su√©ter de Lana", categoria:"Ropa Mujer", precio:"$450", img:"imagenes/imagenes/Ropa de mujer/Su√©terdeLana.jpg"},
  // Ropa Hombre
  {nombre:"Camisa Casual", categoria:"Ropa Hombre", precio:"$430", img:"imagenes/imagenes/Ropa de hombre/CamisaCasual.jpg"},
  {nombre:"Chaqueta de Cuero", categoria:"Ropa Hombre", precio:"$1150", img:"imagenes/imagenes/Ropa de hombre/ChaquetadeCuero.jpg"},
  {nombre:"Jeans Azul", categoria:"Ropa Hombre", precio:"$590", img:"imagenes/imagenes/Ropa de hombre/JeansAzul.jpg"},
  {nombre:"Camisa Blanca", categoria:"Ropa Hombre", precio:"$400", img:"imagenes/imagenes/Ropa de hombre/CamisaBlanca.jpg"},
  // Accesorios Hombre
  {nombre:"Cintur√≥n de cuero", categoria:"Accesorios Hombre", precio:"$250", img:"imagenes/imagenes/Accesorios hombres/Cintur√≥ndecuero.jpg"},
  {nombre:"Reloj elegante", categoria:"Accesorios Hombre", precio:"$980", img:"imagenes/imagenes/Accesorios hombres/RelojElegante.jpg"},
  {nombre:"Gafas de sol", categoria:"Accesorios Hombre", precio:"$310", img:"imagenes/imagenes/Accesorios hombres/Gafasdesol.png"},
  {nombre:"Billetera de cuero", categoria:"Accesorios Hombre", precio:"$260", img:"imagenes/imagenes/Accesorios hombres/Billeteradecuero.jpg"},
  // Accesorios Variados
  {nombre:"Bufanda", categoria:"Accesorios Variados", precio:"$150", img:"imagenes/imagenes/Accesorios Bariados/Bufanda.jpg"},
  {nombre:"Sombrero", categoria:"Accesorios Variados", precio:"$275", img:"imagenes/imagenes/Accesorios Bariados/Sombrero.jpg"},
  {nombre:"Guantes", categoria:"Accesorios Variados", precio:"$180", img:"imagenes/imagenes/Accesorios Bariados/Guantes.jpg"},
  {nombre:"Pulsera", categoria:"Accesorios Variados", precio:"$120", img:"imagenes/imagenes/Accesorios Bariados/Pulsera.jpg"}
];

let carrito = [], estado = "inicio";

const messages = document.getElementById("messages");

function printBot(html){
    messages.innerHTML += `<div class="bot">${html}</div>`;
    messages.scrollTop = messages.scrollHeight;
}
function printUser(html){
    messages.innerHTML += `<div class="user"><b>T√∫:</b> ${html}</div>`;
    messages.scrollTop = messages.scrollHeight;
}

function showQuickMenu(){
    printBot("¬øSobre qu√© tema necesitas ayuda?<br>" +
        `<button class="option-btn" onclick="themeOption('productos')">Productos</button>` +
        `<button class="option-btn" onclick="themeOption('populares')">Lo m√°s popular</button>` +
        `<button class="option-btn" onclick="themeOption('pagos')">Pagos</button>` +
        `<button class="option-btn" onclick="themeOption('env√≠o')">Env√≠os</button>` +
        `<button class="option-btn" onclick="themeOption('contacto')">Contacto humano</button>` +
        `<button class="option-btn" onclick="themeOption('queja')">Quejas</button>` +
        `<button class="option-btn" onclick="themeOption('ayuda')">Gu√≠a de compra</button>`);
}

window.onload = ()=>{ mensajeBienvenida(); };
function mensajeBienvenida(){
    estado = "inicio";
    messages.innerHTML = "";
    printBot("¬°Hola! üëã Soy tu asistente virtual.<br>Puedo ayudarte a conocer productos, pagos, env√≠os, poner queja o conectar con un asesor. ¬øQu√© te gustar√≠a hacer hoy?");
    showQuickMenu();
}
document.getElementById("send").onclick = userMessage;
document.getElementById("input").addEventListener("keydown", (e)=>{ if(e.key==="Enter") userMessage(); });

function userMessage(){
    let msg = document.getElementById("input").value.trim();
    if(!msg) return;
    printUser(msg);
    botReply(msg);
    document.getElementById("input").value = "";
}

function themeOption(op){
    if(op==='productos'){
        estado = "categoria";
        printUser("Quiero informaci√≥n sobre productos");
        printBot(`¬øDe qu√© categor√≠a buscas?<br>
            <button class="option-btn" onclick="categoryProducts('Ropa Mujer')">Ropa Mujer</button>
            <button class="option-btn" onclick="categoryProducts('Ropa Hombre')">Ropa Hombre</button>
            <button class="option-btn" onclick="categoryProducts('Accesorios Hombre')">Accesorios Hombre</button>
            <button class="option-btn" onclick="categoryProducts('Accesorios Variados')">Accesorios Variados</button>
            <button class="option-btn" onclick="mensajeBienvenida()">Men√∫ principal</button>`);
    } else if(op==='populares'){
        printUser("Mu√©strame lo m√°s popular");
        // Mostrar primeros 4 productos sin importar categor√≠a
        productos.slice(0,4).forEach(p=>{
            printBot(`<div class="producto-tarjeta">
                        <img src="${p.img}" alt="${p.nombre}">
                        <div><b>${p.nombre}</b><br>Precio: ${p.precio}<br><small>${p.categoria}</small></div></div>
                        <button class="option-btn" onclick="productDetails('${p.nombre}')">Quiero este</button>`);
        });
        printBot(`<button class="option-btn" onclick="mensajeBienvenida()">Volver al men√∫</button>`);
    } else if(op==='pagos'){
        printUser("Formas de pago disponibles");
        printBot("Aceptamos tarjetas, PayPal, transferencia bancaria, OXXO, Apple Pay y Google Pay.<br><button class='option-btn' onclick='mensajeBienvenida()'>Men√∫ principal</button>");
    } else if(op==='env√≠o'){
        printUser("Opciones de env√≠o");
        printBot("Env√≠o est√°ndar, express, internacional y recojo en tienda. Todos con rastreo.<br><button class='option-btn' onclick='mensajeBienvenida()'>Men√∫ principal</button>");
    } else if(op==='contacto'){
        printUser("Quiero hablar con humano");
        printBot("Puedes escribirnos por WhatsApp: <b>+52-1234-567-890</b> o correo <a href='mailto:soporte@tienda.com'>soporte@tienda.com</a> üí¨<br><button class='option-btn' onclick='mensajeBienvenida()'>Men√∫ principal</button>");
    } else if(op==='queja'){
        printUser("Tengo una queja");
        printBot("Por favor, escribe tu queja. Se mandar√° a soporte especializado.<br><button class='option-btn' onclick='mensajeBienvenida()'>Men√∫ principal</button>");
        estado = "queja";
    } else if(op==='ayuda'){
        printUser("¬øC√≥mo comprar?");
        printBot("Elige producto, agr√©galo al carrito, elige pago y env√≠o. Si necesitas ayuda, dime aqu√≠.<br><button class='option-btn' onclick='mensajeBienvenida()'>Men√∫ principal</button>");
    }
}

function categoryProducts(cat){
    estado = "detalle";
    printUser("Busco "+cat);
    let fil = productos.filter(p=>p.categoria===cat);
    if(fil.length){
        fil.forEach(p=>{
            printBot(`<div class="producto-tarjeta">
                    <img src="${p.img}" alt="${p.nombre}">
                    <div><b>${p.nombre}</b><br>
                    Precio: ${p.precio}<br>
                    <small>${p.categoria}</small></div></div>
                    <button class="option-btn" onclick="productDetails('${p.nombre}')">Agregar al carrito</button>`);
        });
    } else printBot("No hay productos disponibles. ¬øBuscas otra cosa?");
    printBot(`<button class="option-btn" onclick="mensajeBienvenida()">Men√∫ principal</button>`);
}

function productDetails(nombre){
    let p = productos.find(x=>x.nombre==nombre);
    if(p){
        printBot(`<b>${p.nombre}</b><br>
            Precio: <span style='color:#fc6c85;font-weight:bold;'>${p.precio}</span><br>
            Categor√≠a: ${p.categoria}<br>
            Producto disponible.<br>
            <button class="option-btn" onclick="addToCart('${p.nombre}')">Agregar al carrito</button> 
            <button class="option-btn" onclick="mensajeBienvenida()">Men√∫ principal</button>`);
    }
}

function addToCart(nombre){
    carrito.push(nombre);
    printBot(`¬°${nombre} agregado! Tu carrito: <b>${carrito.join(", ")}</b><br>
    <button class="option-btn" onclick="finishCart()">Finalizar compra</button>
    <button class="option-btn" onclick="mensajeBienvenida()">Seguir explorando</button>`);
}

function finishCart(){
    printBot("‚úÖ Compra finalizada. Pronto llegar√° correo de confirmaci√≥n.<br>"+
        "<button class='option-btn' onclick='mensajeBienvenida()'>Nuevo pedido</button>");
    carrito = [];
    estado = "inicio";
}

function botReply(msgRaw){
    let msg = msgRaw.toLowerCase();
    if(estado=="queja"){
        localStorage.setItem("queja_"+Date.now(),msgRaw);
        printBot("Gracias por tu queja. ¬øQuieres regresar al men√∫?");
        printBot(`<button class="option-btn" onclick="mensajeBienvenida()">S√≠, volver</button>`);
        estado = "inicio";
        return;
    }
    if(msg.includes("precio") && msg.includes("jeans")){
        printBot("Jeans mujer: $550, jeans hombre: $590.<br>¬øAgregar al carrito?");
        printBot(`<button class="option-btn" onclick="categoryProducts('Ropa Mujer')">Jeans Mujer</button>
                  <button class="option-btn" onclick="categoryProducts('Ropa Hombre')">Jeans Hombre</button>
                  <button class="option-btn" onclick="mensajeBienvenida()">Men√∫ principal</button>`);
        return;
    }
    if(msg.includes("adios") || msg.includes("salir") || msg.includes("gracias")) {
        printBot("¬°Gracias por tu visita! üëã Puedes regresar con el bot√≥n Men√∫ principal.");
        printBot(`<button class="option-btn" onclick="mensajeBienvenida()">Men√∫ principal</button>`);
        return;
    }
    printBot("No entend√≠ bien tu pregunta. Elige una opci√≥n, revisa el men√∫ o usa palabras como producto, pago, env√≠o, ayuda o queja.");
    printBot(`<button class="option-btn" onclick="mensajeBienvenida()">Men√∫ principal</button>`);
}

function finalizarChat(){
    messages.innerHTML = '';
    printBot("‚úÖ Conversaci√≥n finalizada. ¬øQuieres empezar otra vez? <button class='option-btn' onclick='mensajeBienvenida()'>Nuevo chat</button>");
    carrito = [];
    estado = "inicio";
}
</script>
</body>
</html>
